---
title: "Wells HFI 2021"
format: pdf
---

# EDA

 - Explore the layer o09_WellsActive_HFI_2021 from the [ABMI human footprint](https://abmi.ca/home/data-analytics/da-top/da-product-overview/Human-Footprint-Products/HF-inventory.html)

```{python}
import fiona
import geopandas as gpd
```

```{python}
fiona.listlayers('HFI2021.gdb/HFI2021.gdb')
```

There are two layers about wells:

 - o09_WellsActive_HFI_2021
 - o16_WellsAbnd_HFI_2021

# Wells abandoned

```{python}
abandoned_wells = gpd.read_file('HFI2021.gdb/HFI2021.gdb', 
driver = 'FileGDB', layer = 'o16_WellsAbnd_HFI_2021')
```


```{python}
print(abandoned_wells.head())
```



```{python}
from osgeo import gdal
```



```{python}
fn_in = r"data_in/CA_Forest_Fire_1985-2020/CA_Forest_Fire_1985-2020.tif"
fn_clip = 'data/forest_test.tif'
fn_poly = r"data_in/alberta.gpkg"


gdal.Warp(fn_clip, fn_in, cutlineDSName=fn_poly, cutlineLayer='polygon', cropToCutline=True)
```



```{python}
# Second try with geocomputation with python
# import os
# import math
# import numpy as np
# import matplotlib.pyplot as plt
# import pandas as pd
# import shapely
import geopandas as gpd
import rasterio
# import rasterio.plot
import rasterio.mask
# import rasterio.features
# import rasterstats
```


```{python}
#src_srtm = rasterio.open('data/srtm.tif')
#zion = gpd.read_file('data/zion.gpkg')

# Both files should have same projection. It's easier to and more
# precise to reproject vector layers compared to rasters

#zion = zion.to_crs(src_srtm.crs)


canada_fires = rasterio.open('data_in/CA_Forest_Fire_1985-2020/CA_Forest_Fire_1985-2020.tif')

alberta = gpd.read_file('data_in/alberta.gpkg')
```

```{python}
print(alberta.crs)
print(canada_fires.crs)
```

```{python}
alberta = alberta.to_crs(canada_fires.crs)
```


```{python}
out_image_mask, out_transform_mask = rasterio.mask.mask(
    canada_fires, 
    alberta.geometry, 
    crop=False, 
    nodata=9999
)
```
